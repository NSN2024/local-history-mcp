# Local History MCP Server

> **Access Cursor/VS Code Local History through the Model Context Protocol for AI-powered data recovery**

[![MCP](https://img.shields.io/badge/MCP-Compatible-blue)](https://modelcontextprotocol.io)

## Overview

This MCP server bridges the gap between AI assistants and editor Local History, enabling data recovery and enhanced context awareness. Unlike undo/redo, Local History captures file snapshots at save points, preserving work that would otherwise be lost.

**Problem**: Current AI assistants (Claude, Cursor AI, GitHub Copilot) cannot access Local History data despite having extensive diagnostic capabilities.

**Solution**: Simple MCP server providing direct access to Cursor/VS Code Local History for personal use.

## Installation

### Option 1: Package Manager (Recommended)

Install using your preferred package manager:

```bash
# npm
npm install -g local-history-mcp
# or run without installing
npx local-history-mcp

# pnpm  
pnpm add -g local-history-mcp
# or run without installing
pnpm dlx local-history-mcp

# yarn
yarn global add local-history-mcp
# or run without installing  
yarn dlx local-history-mcp

# bun
bun add -g local-history-mcp
# or run without installing
bunx local-history-mcp
```

### Option 2: From Source

```bash
git clone https://github.com/xxczaki/local-history-mcp.git && cd local-history-mcp
pnpm install
pnpm build
pnpm start
```

## MCP Tools

| Tool | Description |
|------|-------------|
| `list_history_files` | List all files with Local History |
| `get_file_history` | View complete history for a file |
| `get_history_entry` | Get specific history entry content |
| `restore_from_history` | Restore file to previous state (with backup) |
| `search_history_content` | Search across all history entries |
| `get_history_stats` | Overview statistics |

## Configuration

### Cursor

You can install this MCP server in Cursor using the **one-click install button**:

[![Install MCP Server](https://cursor.com/deeplink/mcp-install-dark.svg)](https://cursor.com/en/install-mcp?name=local-history&config=eyJjb21tYW5kIjogIm5weCIsICJhcmdzIjogWyIteSIsICJsb2NhbC1oaXN0b3J5LW1jcCJdfQo%3D)

Or manually configure by following the [official Cursor MCP documentation](https://docs.cursor.com/en/context/mcp).

### Claude Code & Claude Desktop

For **Claude Code** (CLI), install directly:
```bash
claude mcp add local-history -- npx -y local-history-mcp
```

For **Claude Desktop**, see the [official MCP documentation](https://docs.anthropic.com/en/docs/claude-code/mcp).

### VS Code

See the [official documentation](https://code.visualstudio.com/docs/copilot/chat/mcp-servers).

## Development

```bash
# Development mode
pnpm dev

# Run tests
pnpm test
pnpm test:watch

# Linting and formatting
pnpm lint

# Launch MCP Inspector
pnpm inspector
```

## Technical Details

### Storage Locations

| OS | Cursor | VS Code |
|---|--------|---------|
| **macOS** | `~/Library/Application Support/Cursor/User/History` | `~/Library/Application Support/Code/User/History` |
| **Windows** | `%APPDATA%\Cursor\User\History` | `%APPDATA%\Code\User\History` |
| **Linux** | `~/.config/Cursor/User/History` | `~/.config/Code/User/History` |

### Release Process

Releases are managed using [Changesets](https://github.com/changesets/changesets) for better changelog management:

#### 1. Create a changeset
```bash
pnpm changeset
```
This will prompt you to:
- Select the type of change (patch, minor, major)
- Describe what changed

#### 2. Commit the changeset
```bash
git add .changeset/
git commit -m "feat: add new feature"
git push
```

#### 3. Automated release
When you push to `main`, GitHub Actions will:
- ü§ñ Create a release PR if there are pending changesets
- üìù Generate changelogs from your changesets
- üß™ Run tests and linting
- üöÄ Publish to npm with provenance when the PR is merged

#### Manual release (if needed)

```bash
# Version packages and generate changelog
pnpm version-packages

# Publish to npm
pnpm release
```

## AI disclosure

This project contains code generated by Large Language Models (LLMs), under human supervision and proofreading.

### License

MIT
